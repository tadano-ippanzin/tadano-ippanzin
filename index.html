<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #eef2f3; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        textarea { width: 95%; height: 120px; margin: 10px 0; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        textarea:focus { border-color: #007bff; outline: none; }
        .btn-group { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        button { padding: 10px 18px; font-size: 15px; cursor: pointer; border: none; border-radius: 6px; background-color: #007bff; color: white; transition: 0.2s; font-weight: bold; }
        button:hover { background-color: #0056b3; transform: translateY(-1px); }
        .swap-btn { background-color: #6f42c1; }
        .copy-btn { background-color: #28a745; }
        .tweet-btn { background-color: #000000; }
        .delete-btn { background-color: #dc3545; }
        .label { font-weight: bold; display: block; margin-top: 15px; text-align: left; margin-left: 2.5%; color: #333; }
        hr { border: 0; border-top: 1px solid #eee; margin: 20px 0; }
    </style>
</head>
<body>

<div class="container">
    <h2>âš™ï¸ ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·</h2>
    
    <span class="label">å…¥åŠ›ï¼ˆæ—¥æœ¬èªãƒ»æ•°å­—ãƒ»æš—å·ï¼‰:</span>
    <textarea id="inputText" placeholder="ã“ã“ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."></textarea>
    
    <div class="btn-group">
        <button onclick="process('encrypt')">æš—å·åŒ–</button>
        <button onclick="process('decrypt')">å¾©å·</button>
        <button class="swap-btn" onclick="swapText()">å…¥ã‚Œæ›ãˆã‚‹ &#x1F503;</button>
        <button class="copy-btn" onclick="copyText('inputText')">å…¥åŠ›ã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>

    <hr>

    <span class="label">çµæœ:</span>
    <textarea id="outputText" readonly placeholder="çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>
    
    <div class="btn-group">
        <button class="copy-btn" onclick="copyText('outputText')">çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
        <button class="tweet-btn" onclick="tweet()">ğ• ãƒ„ã‚¤ãƒ¼ãƒˆ</button>
        <button class="delete-btn" onclick="clearAll()">å…¨ã¦æ¶ˆå»</button>
    </div>
</div>

<script>
    const mapping = {
        'ã‚': 'ã¬', 'ã„': 'ã‚', 'ã†': 'ã‚“', 'ãˆ': 'ãˆ', 'ãŠ': 'ãŠ',
        'ã‹': 'ã', 'ã': 'ã', 'ã': 'ã‘', 'ã‘': 'ã“', 'ã“': 'ã‹',
        'ã•': 'ã—', 'ã—': 'ã™', 'ã™': 'ã›', 'ã›': 'ã', 'ã': 'ã•',
        'ãŸ': 'ã¡', 'ã¡': 'ã¤', 'ã¤': 'ã¦', 'ã¦': 'ã¨', 'ã¨': 'ãŸ',
        'ãª': 'ã«', 'ã«': 'ã¬', 'ã¬': 'ã­', 'ã­': 'ã®', 'ã®': 'ãª',
        'ã¯': 'ã²', 'ã²': 'ãµ', 'ãµ': 'ã¸', 'ã¸': 'ã»', 'ã»': 'ã¯',
        'ã¾': 'ã¿', 'ã¿': 'ã‚€', 'ã‚€': 'ã‚', 'ã‚': 'ã‚‚', 'ã‚‚': 'ã¾',
        'ã‚„': 'ã‚†', 'ã‚†': 'ã‚ˆ', 'ã‚ˆ': 'ã‚„',
        'ã‚‰': 'ã‚Š', 'ã‚Š': 'ã‚‹', 'ã‚‹': 'ã‚Œ', 'ã‚Œ': 'ã‚', 'ã‚': 'ã‚‰',
        'ã‚': 'ã‚’', 'ã‚’': 'ã‚“', 'ã‚“': 'ã‚',
        '0': 'â¦°', '1': 'â¦‘', '2': 'â¦’', '3': 'â¦“', '4': 'â¦”',
        '5': 'â¦•', '6': 'â¦–', '7': 'â¦—', '8': 'â¦˜', '9': 'â¦™'
    };

    const reverseMapping = Object.fromEntries(Object.entries(mapping).map(([k, v]) => [v, k]));

    function process(mode) {
        const input = document.getElementById('inputText').value;
        const dict = (mode === 'encrypt') ? mapping : reverseMapping;
        let result = "";
        const chars = Array.from(input);
        for (let char of chars) {
            let hiraChar = char.replace(/[\u30a1-\u30f6]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60));
            if (dict[hiraChar]) {
                result += dict[hiraChar];
            } else if (dict[char]) {
                result += dict[char];
            } else {
                result += char;
            }
        }
        document.getElementById('outputText').value = result;
    }

    function swapText() {
        const inputArea = document.getElementById('inputText');
        const outputArea = document.getElementById('outputText');
        const temp = inputArea.value;
        inputArea.value = outputArea.value;
        outputArea.value = temp;
    }

    function copyText(areaId) {
        const text = document.getElementById(areaId);
        if (!text.value) return;
        text.select();
        document.execCommand('copy');
        alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    function clearAll() {
        if(confirm("ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ")) {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
        }
    }

    function tweet() {
        const text = document.getElementById('outputText').value;
        if (!text) return;
        const tweetText = encodeURIComponent("ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·ã§å¤‰æ›ã—ã¾ã—ãŸï¼\n" + text + "\n#ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·");
        window.open(`https://twitter.com/intent/tweet?text=${tweetText}`, '_blank');
    }
</script>

</body>
</html>            } else {
                result += char;
            }
        }
        document.getElementById('outputText').value = result;
    }

    function swapText() {
        const inputArea = document.getElementById('inputText');
        const outputArea = document.getElementById('outputText');
        const temp = inputArea.value;
        inputArea.value = outputArea.value;
        outputArea.value = temp;
    }

    function copyText(areaId) {
        const text = document.getElementById(areaId);
        if (!text.value) return;
        text.select();
        document.execCommand('copy');
        alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    function clearAll() {
        if(confirm("ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ")) {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
        }
    }

    function tweet() {
        const text = document.getElementById('outputText').value;
        if (!text) return;
        const tweetText = encodeURIComponent("ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·ã§å¤‰æ›ã—ã¾ã—ãŸï¼\n" + text + "\n#ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·");
        window.open(`https://twitter.com/intent/tweet?text=${tweetText}`, '_blank');
    }
</script>

</body>
</html><!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #eef2f3; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        textarea { width: 95%; height: 120px; margin: 10px 0; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        textarea:focus { border-color: #007bff; outline: none; }
        .btn-group { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        button { padding: 10px 18px; font-size: 15px; cursor: pointer; border: none; border-radius: 6px; background-color: #007bff; color: white; transition: 0.2s; font-weight: bold; }
        button:hover { background-color: #0056b3; transform: translateY(-1px); }
        .swap-btn { background-color: #6f42c1; }
        .copy-btn { background-color: #28a745; }
        .label { font-weight: bold; display: block; margin-top: 15px; text-align: left; margin-left: 2.5%; color: #333; }
        hr { border: 0; border-top: 1px solid #eee; margin: 20px 0; }
    </style>
</head>
<body>

<div class="container">
    <h2>âš™ï¸ ã‚®ã‚¢ã‚ªã‚¿ãƒƒãƒ‰æš—å·</h2>
    <span class="label">å…¥åŠ›ï¼ˆæ—¥æœ¬èªãƒ»æ•°å­—ãƒ»æš—å·ï¼‰:</span>
    <textarea id="inputText" placeholder="ã“ã“ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."></textarea>
    <div class="btn-group">
        <button onclick="process('encrypt')">æš—å·åŒ–</button>
        <button onclick="process('decrypt')">å¾©å·</button>
        <button class="swap-btn" onclick="swapText()">å…¥ã‚Œæ›ãˆã‚‹ &#x1F503;</button>
        <button class="copy-btn" onclick="copyText('inputText')">å…¥åŠ›ã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
    <hr>
    <span class="label">çµæœ:</span>
    <textarea id="outputText" readonly placeholder="çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>
    <div class="btn-group">
        <button class="copy-btn" onclick="copyText('outputText')">çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
        <button style="background-color: #dc3545;" onclick="clearAll()">å…¨ã¦æ¶ˆå»</button>
    </div>
</div>

<script>
    const mapping = {
        'ã‚': 'ã¬', 'ã„': 'ã‚', 'ã†': 'ã‚“', 'ãˆ': 'ãˆ', 'ãŠ': 'ãŠ',
        'ã‹': 'ã', 'ã': 'ã', 'ã': 'ã‘', 'ã‘': 'ã“', 'ã“': 'ã‹',
        'ã•': 'ã—', 'ã—': 'ã™', 'ã™': 'ã›', 'ã›': 'ã', 'ã': 'ã•',
        'ãŸ': 'ã¡', 'ã¡': 'ã¤', 'ã¤': 'ã¦', 'ã¦': 'ã¨', 'ã¨': 'ãŸ',
        'ãª': 'ã«', 'ã«': 'ã¬', 'ã¬': 'ã­', 'ã­': 'ã®', 'ã®': 'ãª',
        'ã¯': 'ã²', 'ã²': 'ãµ', 'ãµ': 'ã¸', 'ã¸': 'ã»', 'ã»': 'ã¯',
        'ã¾': 'ã¿', 'ã¿': 'ã‚€', 'ã‚€': 'ã‚', 'ã‚': 'ã‚‚', 'ã‚‚': 'ã¾',
        'ã‚„': 'ã‚†', 'ã‚†': 'ã‚ˆ', 'ã‚ˆ': 'ã‚„',
        'ã‚‰': 'ã‚Š', 'ã‚Š': 'ã‚‹', 'ã‚‹': 'ã‚Œ', 'ã‚Œ': 'ã‚', 'ã‚': 'ã‚‰',
        'ã‚': 'ã‚’', 'ã‚’': 'ã‚“', 'ã‚“': 'ã‚',
        '0': 'â¦°', '1': 'â¦‘', '2': 'â¦’', '3': 'â¦“', '4': 'â¦”',
        '5': 'â¦•', '6': 'â¦–', '7': 'â¦—', '8': 'â¦˜', '9': 'â¦™'
    };

    const reverseMapping = Object.fromEntries(Object.entries(mapping).map(([k, v]) => [v, k]));

    function process(mode) {
        const input = document.getElementById('inputText').value;
        const dict = (mode === 'encrypt') ? mapping : reverseMapping;
        let result = "";
        
        // çµµæ–‡å­—ãƒ»ç‰¹æ®Šæ–‡å­—å¯¾å¿œã®åˆ†å‰²
        const chars = Array.from(input);

        for (let char of chars) {
            let hiraChar = char.replace(/[\u30a1-\u30f6]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60));
            if (dict[hiraChar]) {
                result += dict[hiraChar];
            } else if (dict[char]) {
                result += dict[char];
            } else {
                result += char;
            }
        }
        document.getElementById('outputText').value = result;
    }

    function swapText() {
        const inputArea = document.getElementById('inputText');
        const outputArea = document.getElementById('outputText');
        const temp = inputArea.value;
        inputArea.value = outputArea.value;
        outputArea.value = temp;
    }

    function copyText(areaId) {
        const text = document.getElementById(areaId);
        if (!text.value) return;
        text.select();
        document.execCommand('copy');
        alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    function clearAll() {
        if(confirm("ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ")) {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
        }
    }
</script>
</body>
</html>    <div id="debug" class="debug-info">ã“ã“ã«å·¥ç¨‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
</div>

<script>
// åŸºæœ¬å¤‰æ›ãƒãƒƒãƒ—
const rToK = {"shi":"ã—","chi":"ã¡","tsu":"ã¤","kya":"ãã‚ƒ","kyu":"ãã‚…","kyo":"ãã‚‡","sha":"ã—ã‚ƒ","shu":"ã—ã‚…","sho":"ã—ã‚‡","cha":"ã¡ã‚ƒ","chu":"ã¡ã‚…","cho":"ã¡ã‚‡","nya":"ã«ã‚ƒ","nyu":"ã«ã‚…","nyo":"ã«ã‚‡","hya":"ã²ã‚ƒ","hyu":"ã²ã‚ƒ","hyo":"ã²ã‚‡","mya":"ã¿ã‚ƒ","myu":"ã¿ã‚…","myo":"ã¿ã‚‡","rya":"ã‚Šã‚ƒ","ryu":"ã‚Šã‚ƒ","ryo":"ã‚Šã‚‡","gya":"ãã‚ƒ","gyu":"ãã‚…","gyo":"ãã‚‡","ja":"ã˜ã‚ƒ","ju":"ã˜ã‚…","jo":"ã˜ã‚‡","bya":"ã³ã‚ƒ","byu":"ã³ã‚…","byo":"ã³ã‚‡","pya":"ã´ã‚ƒ","pyu":"ã´ã‚…","pyo":"ã´ã‚‡","ka":"ã‹","ki":"ã","ku":"ã","ke":"ã‘","ko":"ã“","sa":"ã•","su":"ã™","se":"ã›","so":"ã","ta":"ãŸ","te":"ã¦","to":"ã¨","na":"ãª","ni":"ã«","nu":"ã¬","ne":"ã­","no":"ã®","ha":"ã¯","hi":"ã²","fu":"ãµ","he":"ã¸","ho":"ã»","ma":"ã¾","mi":"ã¿","mu":"ã‚€","me":"ã‚","mo":"ã‚‚","ya":"ã‚„","yu":"ã‚†","yo":"ã‚ˆ","ra":"ã‚‰","ri":"ã‚Š","ru":"ã‚‹","re":"ã‚Œ","ro":"ã‚","wa":"ã‚","wo":"ã‚’","nn":"ã‚“","ga":"ãŒ","gi":"ã","gu":"ã","ge":"ã’","go":"ã”","za":"ã–","ji":"ã˜","zu":"ãš","ze":"ãœ","zo":"ã","da":"ã ","di":"ã¢","du":"ã¥","de":"ã§","do":"ã©","ba":"ã°","bi":"ã³","bu":"ã¶","be":"ã¹","bo":"ã¼","pa":"ã±","pi":"ã´","pu":"ã·","pe":"ãº","po":"ã½","a":"ã‚","i":"ã„","u":"ã†","e":"ãˆ","o":"ãŠ"};
const kToR = Object.fromEntries(Object.entries(rToK).map(([k,v])=>[v,k]));
const kToM = {"ã¬":"1","ãµ":"2","ã‚":"3","ã†":"4","ãˆ":"5","ãŠ":"6","ã‚„":"7","ã‚†":"8","ã‚ˆ":"9","ã‚":"0","ã»":"-","ã¸":"^","ãŸ":"Q","ã¦":"W","ã„":"E","ã™":"R","ã‹":"T","ã‚“":"Y","ãª":"U","ã«":"I","ã‚‰":"O","ã›":"P","ã ":"@","ã‚€":"[","ã¡":"A","ã¨":"S","ã—":"D","ã¯":"F","ã":"G","ã":"H","ã¾":"J","ã®":"K","ã‚Š":"L","ã‚Œ":";","ã‘":":","ã¤":"Z","ã•":"X","ã":"C","ã²":"V","ã“":"B","ã¿":"N","ã‚‚":"M","ã­":",","ã‚‹":".","ã‚":"/","ãƒ¼":"-"};
const mToK = Object.fromEntries(Object.entries(kToM).map(([k,v])=>[v,k]));

function kataToHira(str) { return str.replace(/[ã‚¡-ãƒ¶]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60)); }
function rot47(t){ return t.split('').map(c=>{let n=c.charCodeAt(0);return(n>=33&&n<=126)?String.fromCharCode(33+((n-33+47)%94)):c}).join('');}

// ã‚¨ãƒ‹ã‚°ãƒï¼šå…¨æ–‡å­—å¯¾å¿œã‹ã¤ä½ç½®ã‚ºãƒ¬ã‚’å®Œå…¨ä¿®æ­£
function enigmaStep(c, pos, reverse) {
    let n = c.charCodeAt(0);
    let shift = pos % 94; 
    if (n >= 33 && n <= 126) {
        if (!reverse) {
            return String.fromCharCode(33 + ((n - 33 + shift) % 94));
        } else {
            return String.fromCharCode(33 + ((n - 33 - shift + 94) % 94));
        }
    }
    return c;
}

function run(isEnc) {
    let input = document.getElementById('input').value;
    if(!input) return;
    let res = "";
    if(isEnc) {
        let s0 = kataToHira(input.toLowerCase());
        const sk = Object.keys(rToK).sort((a,b)=>b.length - a.length);
        for(let k of sk){ s0 = s0.split(k).join(rToK[k]); }
        let s1 = s0.split('').map(c=>kToM[c]||c).join('');
        let s2 = rot47(s1);
        // ã‚¨ãƒ‹ã‚°ãƒå¤‰æ›
        let s3 = s2.split('').map((c, i) => enigmaStep(c, i, false)).join('');
        res = s3.split('').reverse().join('');
        document.getElementById('debug').innerText = `[æš—å·åŒ–] å®Œäº†`;
    } else {
        let s1 = input.split('').reverse().join('');
        // ã‚¨ãƒ‹ã‚°ãƒæˆ»ã—
        let s2 = s1.split('').map((c, i) => enigmaStep(c, i, true)).join('');
        let s3 = rot47(s2);
        let s4 = s3.split('').map(c=>mToK[c]||c).join('');
        const sk = Object.keys(kToR).sort((a,b)=>b.length - a.length);
        for(let k of sk){ s4 = s4.split(k).join(kToR[k]); }
        res = s4;
        document.getElementById('debug').innerText = `[å¾©å·åŒ–] å®Œäº†`;
    }
    document.getElementById('resultText').innerText = res;
}

function swap(){
    const currentRes = document.getElementById('resultText').innerText;
    if(currentRes) document.getElementById('input').value = currentRes;
}

function copyResult(){
    const t = document.getElementById('resultText').innerText;
    if(!t) return;
    // å¤ã„ç«¯æœ«ã§ã‚‚å‹•ãã‚³ãƒ”ãƒ¼æ–¹å¼
    const textArea = document.createElement("textarea");
    textArea.value = t;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
}
</script>
</body>
</html>
<!--ã‚¸ãƒ­ã‚¸ãƒ­è¦‹ã‚“ãªã‚„ã€‚ã‚½ãƒ¼ã‚¹ã‚’ã€‚-->
